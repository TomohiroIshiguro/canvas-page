<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Canvas tutorial</title>
    <link rel="stylesheet" href="./style.css" />
  </head>

  <body onload="main();">
    <h1>Canvas page</h1>
    <p>
      以下の背景色が黄色い領域が Canvas です。<br />
      <label>モード:</label>
      <input
        type="radio"
        id="m_view"
        name="mode"
        value="view"
        checked="checked"
      />
      <label for="m_view">閲覧</label>
      <input type="radio" id="m_edit" name="mode" value="edit" />
      <label for="m_edit">編集</label>
    </p>

    <div id="row">
      <main>
        <canvas id="tutorial"></canvas>
      </main>
      <aside id="config-forms"></aside>
    </div>
    <div id="elements-control-bar">
      <label>末尾に追加: </label>
      <button onclick="canvasPage.addH1();">見出し 1</button>
      <button onclick="canvasPage.addH2();">見出し 2</button>
      <button onclick="canvasPage.addRect();">本文</button>
      <button onclick="canvasPage.addImage();">静止画</button>
      <button onclick="canvasPage.addVideoPlayer();">動画</button>
      <label>スタンプ: </label>
      <button onclick="canvasPage.addSmileStamp();">スマイル</button>
      <button onclick="canvasPage.addDoneStamp();">済み</button>
      <label>再描画: </label>
      <button onclick="canvasPage.drawInitial();">初期値</button>
      <button onclick="canvasPage.drawEdited();">編集中</button>
      <label>初期化: </label>
      <button onclick="canvasPage.resetEdited();">リセット</button>
    </div>

    <script>
      var canvasPage;
      var sideForms;

      function main() {
        // ページ描画
        let isEditing = false;
        canvasPage = new CanvasPage(initial, stamps_initial, isEditing);
        canvasPage.draw();
        // 編集エリア生成
        sideForms = new SideForms(canvasPage);
        sideForms.showForms();
        canvasPage.setSideForms(sideForms);

        // モードを切り替えた場合
        const radios = document.querySelectorAll(
          "input[type='radio'][name='mode']"
        );
        for (el of radios) {
          el.addEventListener("change", (e) => {
            isEditing = e.target.value == "edit";
            canvasPage.setIsEditing(isEditing);
            canvasPage.draw();
            sideForms.showForms();
          });
        }

        // ウィンドウサイズが変化した場合
        window.addEventListener("resize", () => {
          sideForms.showForms();
        });
      }
    </script>
    <script src="./canvas-page.js"></script>
    <script src="./aside-forms.js"></script>
    <script src="./constants.js"></script>
    <script src="./sample-data.js"></script>
  </body>
</html>
